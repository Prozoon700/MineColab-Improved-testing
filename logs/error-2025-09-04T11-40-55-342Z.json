{
  "timestamp": "2025-09-04T11:40:55.342Z",
  "error": {
    "date": "2025-09-04T11:40:55.342Z",
    "reason": "Input validation failed: [\n  {\n    \"code\": \"invalid_union\",\n    \"unionErrors\": [\n      {\n        \"issues\": [\n          {\n            \"code\": \"invalid_union\",\n            \"unionErrors\": [\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_type\",\n                    \"expected\": \"string\",\n                    \"received\": \"array\",\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\"\n                    ],\n                    \"message\": \"Expected string, received array\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              },\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_type\",\n                    \"expected\": \"string\",\n                    \"received\": \"undefined\",\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\",\n                      1,\n                      \"text\"\n                    ],\n                    \"message\": \"Required\"\n                  },\n                  {\n                    \"received\": \"image_url\",\n                    \"code\": \"invalid_enum_value\",\n                    \"options\": [\n                      \"text\"\n                    ],\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\",\n                      1,\n                      \"type\"\n                    ],\n                    \"message\": \"Invalid enum value. Expected 'text', received 'image_url'\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              }\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"content\"\n            ],\n            \"message\": \"Invalid input\"\n          },\n          {\n            \"received\": \"user\",\n            \"code\": \"invalid_enum_value\",\n            \"options\": [\n              \"system\"\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"role\"\n            ],\n            \"message\": \"Invalid enum value. Expected 'system', received 'user'\"\n          },\n          {\n            \"received\": \"user\",\n            \"code\": \"invalid_literal\",\n            \"expected\": \"system\",\n            \"path\": [\n              \"messages\",\n              0,\n              \"role\"\n            ],\n            \"message\": \"Invalid literal value, expected \\\"system\\\"\"\n          }\n        ],\n        \"name\": \"ZodError\"\n      },\n      {\n        \"issues\": [\n          {\n            \"code\": \"invalid_union\",\n            \"unionErrors\": [\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_type\",\n                    \"expected\": \"string\",\n                    \"received\": \"array\",\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\"\n                    ],\n                    \"message\": \"Expected string, received array\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              },\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_union\",\n                    \"unionErrors\": [\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_union\",\n                            \"unionErrors\": [\n                              {\n                                \"issues\": [\n                                  {\n                                    \"code\": \"invalid_type\",\n                                    \"expected\": \"object\",\n                                    \"received\": \"undefined\",\n                                    \"path\": [\n                                      \"messages\",\n                                      0,\n                                      \"content\",\n                                      1,\n                                      \"imageUrl\"\n                                    ],\n                                    \"message\": \"Required\"\n                                  }\n                                ],\n                                \"name\": \"ZodError\"\n                              },\n                              {\n                                \"issues\": [\n                                  {\n                                    \"code\": \"invalid_type\",\n                                    \"expected\": \"string\",\n                                    \"received\": \"undefined\",\n                                    \"path\": [\n                                      \"messages\",\n                                      0,\n                                      \"content\",\n                                      1,\n                                      \"imageUrl\"\n                                    ],\n                                    \"message\": \"Required\"\n                                  }\n                                ],\n                                \"name\": \"ZodError\"\n                              }\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"imageUrl\"\n                            ],\n                            \"message\": \"Invalid input\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      },\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"string\",\n                            \"received\": \"undefined\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"text\"\n                            ],\n                            \"message\": \"Required\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_enum_value\",\n                            \"options\": [\n                              \"text\"\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid enum value. Expected 'text', received 'image_url'\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_literal\",\n                            \"expected\": \"text\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid literal value, expected \\\"text\\\"\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      },\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"array\",\n                            \"received\": \"undefined\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"referenceIds\"\n                            ],\n                            \"message\": \"Required\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_enum_value\",\n                            \"options\": [\n                              \"reference\"\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid enum value. Expected 'reference', received 'image_url'\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_literal\",\n                            \"expected\": \"reference\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid literal value, expected \\\"reference\\\"\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      }\n                    ],\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\",\n                      1\n                    ],\n                    \"message\": \"Invalid input\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              }\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"content\"\n            ],\n            \"message\": \"Invalid input\"\n          }\n        ],\n        \"name\": \"ZodError\"\n      },\n      {\n        \"issues\": [\n          {\n            \"code\": \"invalid_union\",\n            \"unionErrors\": [\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_type\",\n                    \"expected\": \"string\",\n                    \"received\": \"array\",\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\"\n                    ],\n                    \"message\": \"Expected string, received array\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              },\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_union\",\n                    \"unionErrors\": [\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_union\",\n                            \"unionErrors\": [\n                              {\n                                \"issues\": [\n                                  {\n                                    \"code\": \"invalid_type\",\n                                    \"expected\": \"object\",\n                                    \"received\": \"undefined\",\n                                    \"path\": [\n                                      \"messages\",\n                                      0,\n                                      \"content\",\n                                      1,\n                                      \"imageUrl\"\n                                    ],\n                                    \"message\": \"Required\"\n                                  }\n                                ],\n                                \"name\": \"ZodError\"\n                              },\n                              {\n                                \"issues\": [\n                                  {\n                                    \"code\": \"invalid_type\",\n                                    \"expected\": \"string\",\n                                    \"received\": \"undefined\",\n                                    \"path\": [\n                                      \"messages\",\n                                      0,\n                                      \"content\",\n                                      1,\n                                      \"imageUrl\"\n                                    ],\n                                    \"message\": \"Required\"\n                                  }\n                                ],\n                                \"name\": \"ZodError\"\n                              }\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"imageUrl\"\n                            ],\n                            \"message\": \"Invalid input\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      },\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"string\",\n                            \"received\": \"undefined\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"text\"\n                            ],\n                            \"message\": \"Required\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_enum_value\",\n                            \"options\": [\n                              \"text\"\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid enum value. Expected 'text', received 'image_url'\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_literal\",\n                            \"expected\": \"text\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid literal value, expected \\\"text\\\"\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      },\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"array\",\n                            \"received\": \"undefined\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"referenceIds\"\n                            ],\n                            \"message\": \"Required\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_enum_value\",\n                            \"options\": [\n                              \"reference\"\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid enum value. Expected 'reference', received 'image_url'\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_literal\",\n                            \"expected\": \"reference\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid literal value, expected \\\"reference\\\"\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      }\n                    ],\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\",\n                      1\n                    ],\n                    \"message\": \"Invalid input\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              }\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"content\"\n            ],\n            \"message\": \"Invalid input\"\n          },\n          {\n            \"received\": \"user\",\n            \"code\": \"invalid_enum_value\",\n            \"options\": [\n              \"assistant\"\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"role\"\n            ],\n            \"message\": \"Invalid enum value. Expected 'assistant', received 'user'\"\n          },\n          {\n            \"received\": \"user\",\n            \"code\": \"invalid_literal\",\n            \"expected\": \"assistant\",\n            \"path\": [\n              \"messages\",\n              0,\n              \"role\"\n            ],\n            \"message\": \"Invalid literal value, expected \\\"assistant\\\"\"\n          }\n        ],\n        \"name\": \"ZodError\"\n      },\n      {\n        \"issues\": [\n          {\n            \"code\": \"invalid_union\",\n            \"unionErrors\": [\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_type\",\n                    \"expected\": \"string\",\n                    \"received\": \"array\",\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\"\n                    ],\n                    \"message\": \"Expected string, received array\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              },\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_union\",\n                    \"unionErrors\": [\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_union\",\n                            \"unionErrors\": [\n                              {\n                                \"issues\": [\n                                  {\n                                    \"code\": \"invalid_type\",\n                                    \"expected\": \"object\",\n                                    \"received\": \"undefined\",\n                                    \"path\": [\n                                      \"messages\",\n                                      0,\n                                      \"content\",\n                                      1,\n                                      \"imageUrl\"\n                                    ],\n                                    \"message\": \"Required\"\n                                  }\n                                ],\n                                \"name\": \"ZodError\"\n                              },\n                              {\n                                \"issues\": [\n                                  {\n                                    \"code\": \"invalid_type\",\n                                    \"expected\": \"string\",\n                                    \"received\": \"undefined\",\n                                    \"path\": [\n                                      \"messages\",\n                                      0,\n                                      \"content\",\n                                      1,\n                                      \"imageUrl\"\n                                    ],\n                                    \"message\": \"Required\"\n                                  }\n                                ],\n                                \"name\": \"ZodError\"\n                              }\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"imageUrl\"\n                            ],\n                            \"message\": \"Invalid input\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      },\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"string\",\n                            \"received\": \"undefined\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"text\"\n                            ],\n                            \"message\": \"Required\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_enum_value\",\n                            \"options\": [\n                              \"text\"\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid enum value. Expected 'text', received 'image_url'\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_literal\",\n                            \"expected\": \"text\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid literal value, expected \\\"text\\\"\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      },\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"array\",\n                            \"received\": \"undefined\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"referenceIds\"\n                            ],\n                            \"message\": \"Required\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_enum_value\",\n                            \"options\": [\n                              \"reference\"\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid enum value. Expected 'reference', received 'image_url'\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_literal\",\n                            \"expected\": \"reference\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid literal value, expected \\\"reference\\\"\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      }\n                    ],\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\",\n                      1\n                    ],\n                    \"message\": \"Invalid input\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              }\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"content\"\n            ],\n            \"message\": \"Invalid input\"\n          },\n          {\n            \"received\": \"user\",\n            \"code\": \"invalid_enum_value\",\n            \"options\": [\n              \"tool\"\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"role\"\n            ],\n            \"message\": \"Invalid enum value. Expected 'tool', received 'user'\"\n          },\n          {\n            \"received\": \"user\",\n            \"code\": \"invalid_literal\",\n            \"expected\": \"tool\",\n            \"path\": [\n              \"messages\",\n              0,\n              \"role\"\n            ],\n            \"message\": \"Invalid literal value, expected \\\"tool\\\"\"\n          }\n        ],\n        \"name\": \"ZodError\"\n      }\n    ],\n    \"path\": [\n      \"messages\",\n      0\n    ],\n    \"message\": \"Invalid input\"\n  }\n]",
    "details": "SDKValidationError: Input validation failed: [\n  {\n    \"code\": \"invalid_union\",\n    \"unionErrors\": [\n      {\n        \"issues\": [\n          {\n            \"code\": \"invalid_union\",\n            \"unionErrors\": [\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_type\",\n                    \"expected\": \"string\",\n                    \"received\": \"array\",\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\"\n                    ],\n                    \"message\": \"Expected string, received array\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              },\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_type\",\n                    \"expected\": \"string\",\n                    \"received\": \"undefined\",\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\",\n                      1,\n                      \"text\"\n                    ],\n                    \"message\": \"Required\"\n                  },\n                  {\n                    \"received\": \"image_url\",\n                    \"code\": \"invalid_enum_value\",\n                    \"options\": [\n                      \"text\"\n                    ],\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\",\n                      1,\n                      \"type\"\n                    ],\n                    \"message\": \"Invalid enum value. Expected 'text', received 'image_url'\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              }\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"content\"\n            ],\n            \"message\": \"Invalid input\"\n          },\n          {\n            \"received\": \"user\",\n            \"code\": \"invalid_enum_value\",\n            \"options\": [\n              \"system\"\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"role\"\n            ],\n            \"message\": \"Invalid enum value. Expected 'system', received 'user'\"\n          },\n          {\n            \"received\": \"user\",\n            \"code\": \"invalid_literal\",\n            \"expected\": \"system\",\n            \"path\": [\n              \"messages\",\n              0,\n              \"role\"\n            ],\n            \"message\": \"Invalid literal value, expected \\\"system\\\"\"\n          }\n        ],\n        \"name\": \"ZodError\"\n      },\n      {\n        \"issues\": [\n          {\n            \"code\": \"invalid_union\",\n            \"unionErrors\": [\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_type\",\n                    \"expected\": \"string\",\n                    \"received\": \"array\",\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\"\n                    ],\n                    \"message\": \"Expected string, received array\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              },\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_union\",\n                    \"unionErrors\": [\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_union\",\n                            \"unionErrors\": [\n                              {\n                                \"issues\": [\n                                  {\n                                    \"code\": \"invalid_type\",\n                                    \"expected\": \"object\",\n                                    \"received\": \"undefined\",\n                                    \"path\": [\n                                      \"messages\",\n                                      0,\n                                      \"content\",\n                                      1,\n                                      \"imageUrl\"\n                                    ],\n                                    \"message\": \"Required\"\n                                  }\n                                ],\n                                \"name\": \"ZodError\"\n                              },\n                              {\n                                \"issues\": [\n                                  {\n                                    \"code\": \"invalid_type\",\n                                    \"expected\": \"string\",\n                                    \"received\": \"undefined\",\n                                    \"path\": [\n                                      \"messages\",\n                                      0,\n                                      \"content\",\n                                      1,\n                                      \"imageUrl\"\n                                    ],\n                                    \"message\": \"Required\"\n                                  }\n                                ],\n                                \"name\": \"ZodError\"\n                              }\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"imageUrl\"\n                            ],\n                            \"message\": \"Invalid input\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      },\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"string\",\n                            \"received\": \"undefined\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"text\"\n                            ],\n                            \"message\": \"Required\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_enum_value\",\n                            \"options\": [\n                              \"text\"\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid enum value. Expected 'text', received 'image_url'\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_literal\",\n                            \"expected\": \"text\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid literal value, expected \\\"text\\\"\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      },\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"array\",\n                            \"received\": \"undefined\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"referenceIds\"\n                            ],\n                            \"message\": \"Required\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_enum_value\",\n                            \"options\": [\n                              \"reference\"\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid enum value. Expected 'reference', received 'image_url'\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_literal\",\n                            \"expected\": \"reference\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid literal value, expected \\\"reference\\\"\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      }\n                    ],\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\",\n                      1\n                    ],\n                    \"message\": \"Invalid input\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              }\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"content\"\n            ],\n            \"message\": \"Invalid input\"\n          }\n        ],\n        \"name\": \"ZodError\"\n      },\n      {\n        \"issues\": [\n          {\n            \"code\": \"invalid_union\",\n            \"unionErrors\": [\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_type\",\n                    \"expected\": \"string\",\n                    \"received\": \"array\",\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\"\n                    ],\n                    \"message\": \"Expected string, received array\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              },\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_union\",\n                    \"unionErrors\": [\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_union\",\n                            \"unionErrors\": [\n                              {\n                                \"issues\": [\n                                  {\n                                    \"code\": \"invalid_type\",\n                                    \"expected\": \"object\",\n                                    \"received\": \"undefined\",\n                                    \"path\": [\n                                      \"messages\",\n                                      0,\n                                      \"content\",\n                                      1,\n                                      \"imageUrl\"\n                                    ],\n                                    \"message\": \"Required\"\n                                  }\n                                ],\n                                \"name\": \"ZodError\"\n                              },\n                              {\n                                \"issues\": [\n                                  {\n                                    \"code\": \"invalid_type\",\n                                    \"expected\": \"string\",\n                                    \"received\": \"undefined\",\n                                    \"path\": [\n                                      \"messages\",\n                                      0,\n                                      \"content\",\n                                      1,\n                                      \"imageUrl\"\n                                    ],\n                                    \"message\": \"Required\"\n                                  }\n                                ],\n                                \"name\": \"ZodError\"\n                              }\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"imageUrl\"\n                            ],\n                            \"message\": \"Invalid input\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      },\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"string\",\n                            \"received\": \"undefined\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"text\"\n                            ],\n                            \"message\": \"Required\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_enum_value\",\n                            \"options\": [\n                              \"text\"\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid enum value. Expected 'text', received 'image_url'\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_literal\",\n                            \"expected\": \"text\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid literal value, expected \\\"text\\\"\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      },\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"array\",\n                            \"received\": \"undefined\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"referenceIds\"\n                            ],\n                            \"message\": \"Required\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_enum_value\",\n                            \"options\": [\n                              \"reference\"\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid enum value. Expected 'reference', received 'image_url'\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_literal\",\n                            \"expected\": \"reference\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid literal value, expected \\\"reference\\\"\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      }\n                    ],\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\",\n                      1\n                    ],\n                    \"message\": \"Invalid input\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              }\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"content\"\n            ],\n            \"message\": \"Invalid input\"\n          },\n          {\n            \"received\": \"user\",\n            \"code\": \"invalid_enum_value\",\n            \"options\": [\n              \"assistant\"\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"role\"\n            ],\n            \"message\": \"Invalid enum value. Expected 'assistant', received 'user'\"\n          },\n          {\n            \"received\": \"user\",\n            \"code\": \"invalid_literal\",\n            \"expected\": \"assistant\",\n            \"path\": [\n              \"messages\",\n              0,\n              \"role\"\n            ],\n            \"message\": \"Invalid literal value, expected \\\"assistant\\\"\"\n          }\n        ],\n        \"name\": \"ZodError\"\n      },\n      {\n        \"issues\": [\n          {\n            \"code\": \"invalid_union\",\n            \"unionErrors\": [\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_type\",\n                    \"expected\": \"string\",\n                    \"received\": \"array\",\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\"\n                    ],\n                    \"message\": \"Expected string, received array\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              },\n              {\n                \"issues\": [\n                  {\n                    \"code\": \"invalid_union\",\n                    \"unionErrors\": [\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_union\",\n                            \"unionErrors\": [\n                              {\n                                \"issues\": [\n                                  {\n                                    \"code\": \"invalid_type\",\n                                    \"expected\": \"object\",\n                                    \"received\": \"undefined\",\n                                    \"path\": [\n                                      \"messages\",\n                                      0,\n                                      \"content\",\n                                      1,\n                                      \"imageUrl\"\n                                    ],\n                                    \"message\": \"Required\"\n                                  }\n                                ],\n                                \"name\": \"ZodError\"\n                              },\n                              {\n                                \"issues\": [\n                                  {\n                                    \"code\": \"invalid_type\",\n                                    \"expected\": \"string\",\n                                    \"received\": \"undefined\",\n                                    \"path\": [\n                                      \"messages\",\n                                      0,\n                                      \"content\",\n                                      1,\n                                      \"imageUrl\"\n                                    ],\n                                    \"message\": \"Required\"\n                                  }\n                                ],\n                                \"name\": \"ZodError\"\n                              }\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"imageUrl\"\n                            ],\n                            \"message\": \"Invalid input\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      },\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"string\",\n                            \"received\": \"undefined\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"text\"\n                            ],\n                            \"message\": \"Required\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_enum_value\",\n                            \"options\": [\n                              \"text\"\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid enum value. Expected 'text', received 'image_url'\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_literal\",\n                            \"expected\": \"text\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid literal value, expected \\\"text\\\"\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      },\n                      {\n                        \"issues\": [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"array\",\n                            \"received\": \"undefined\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"referenceIds\"\n                            ],\n                            \"message\": \"Required\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_enum_value\",\n                            \"options\": [\n                              \"reference\"\n                            ],\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid enum value. Expected 'reference', received 'image_url'\"\n                          },\n                          {\n                            \"received\": \"image_url\",\n                            \"code\": \"invalid_literal\",\n                            \"expected\": \"reference\",\n                            \"path\": [\n                              \"messages\",\n                              0,\n                              \"content\",\n                              1,\n                              \"type\"\n                            ],\n                            \"message\": \"Invalid literal value, expected \\\"reference\\\"\"\n                          }\n                        ],\n                        \"name\": \"ZodError\"\n                      }\n                    ],\n                    \"path\": [\n                      \"messages\",\n                      0,\n                      \"content\",\n                      1\n                    ],\n                    \"message\": \"Invalid input\"\n                  }\n                ],\n                \"name\": \"ZodError\"\n              }\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"content\"\n            ],\n            \"message\": \"Invalid input\"\n          },\n          {\n            \"received\": \"user\",\n            \"code\": \"invalid_enum_value\",\n            \"options\": [\n              \"tool\"\n            ],\n            \"path\": [\n              \"messages\",\n              0,\n              \"role\"\n            ],\n            \"message\": \"Invalid enum value. Expected 'tool', received 'user'\"\n          },\n          {\n            \"received\": \"user\",\n            \"code\": \"invalid_literal\",\n            \"expected\": \"tool\",\n            \"path\": [\n              \"messages\",\n              0,\n              \"role\"\n            ],\n            \"message\": \"Invalid literal value, expected \\\"tool\\\"\"\n          }\n        ],\n        \"name\": \"ZodError\"\n      }\n    ],\n    \"path\": [\n      \"messages\",\n      0\n    ],\n    \"message\": \"Invalid input\"\n  }\n]\n    at safeParse (/workspaces/MineColab-Improved-testing/node_modules/@mistralai/mistralai/lib/schemas.js:38:33)\n    at chatComplete (/workspaces/MineColab-Improved-testing/node_modules/@mistralai/mistralai/funcs/chatComplete.js:42:47)\n    at Chat.complete (/workspaces/MineColab-Improved-testing/node_modules/@mistralai/mistralai/sdk/chat.js:43:76)\n    at generateResponse (file:///workspaces/MineColab-Improved-testing/utils/mistral.js:146:39)\n    at generateResponseWithTimeout (file:///workspaces/MineColab-Improved-testing/events/messageCreate.js:157:17)\n    at handleMessageCreate (file:///workspaces/MineColab-Improved-testing/events/messageCreate.js:109:40)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)"
  },
  "context": {
    "messageContent": "?",
    "userId": "762281328733192223",
    "channelId": "1327966840013455390",
    "isTicket": false
  },
  "response": {
    "aiResponse": null,
    "finalReply": "❌ There was a problem generating the response. Please try again in a few seconds... If the problem persists, please contact an administrator."
  }
}